var ReverseInfiniteScroll=function(){function e(){a=ajaxFiltersHistory.state().visiblePage?ajaxFiltersHistory.state().visiblePage:1,$(window).on("scroll.reverseInfiniteScrollInit",function(){$(window).scrollTop();f||(f=!0,scrollTimer=setTimeout(function(){i(),f=!1},250)),f&&clearTimeout(scrollTimer),scrollTimer=setTimeout(function(){scrollTimer=null,i(),o(),ajaxFiltersHistory.setScrollPosition($(window).scrollTop()),f=!1},300)}),$(document).on("nopAjaxFiltersFiltrationCompleteEvent.reverseInfiniteScrollInit",function(e){e.isTriggeredByInfiniteScroll||m||t(),r(),i(),o(),m=!1}),$(document).ready(function(){s=parseInt($(".productsPageSizeDropDown").val()||$(".nop7SpikesAjaxFiltersGrid .item-box").length),1==a&&(p=!0)})}function t(){f=!1,u=".nop7SpikesAjaxFiltersGrid .item-box",p=!1,_previousHash=window.location.hash,_isPreviousRequestFiltration=!1,m=!0,ajaxFiltersHistory.resetState(),e()}function i(){if(p){var e=$(u),t=e.filter(function(){return l($(this))}).last(),i=0;for(i=0;i<e.length&&!$(e.get(i)).is(t);i++);a=Math.ceil(i/s),ajaxFiltersHistory.setVisiblePage(a)}}function r(){if(!p){var e,t=!1,i=$(".ajaxBusyPanelParent .item-grid");for(e=a-1;e>0;e--)for(var r=n(e),o=0;o<s;o++)i.prepend(r),t=!0;t&&setTimeout(function(){$("html, body").animate({scrollTop:v},0)},500),p=!0}}function o(){for(var e=$(d),t=s-1;t<e.length;t+=s){var i=e.get(t),r=$(i).offset().top+$(i).outerHeight(!0)+150;if($(window).scrollTop()<r+150){_reverseInfiniteScrollTriggered=!0;var o=$(i).attr("data-pageNumber");filterManager.executeReverseInfiniteScroll(o)}}}function n(e){var t=$(u).first().clone();$(t).find(".product-title").empty(),$(t).find(".prices").empty,$(t).find(".description").empty(),$(t).find(".picture a").removeAttr("href"),$(t).find(".picture a img").removeAttr("src"),$(t).addClass("dummy-box"),$(t).attr("data-pageNumber",e);var i=document.createElement("div");return i.appendChild(t.get(0)),i.innerHTML}function l(e){var t=$(e).offset().top,i=t+$(e).outerHeight(),r=$(window).scrollTop(),o=r+$(window).height();return i>r&&t<o}var a,s,c={init:e,reset:t,createEmptySpaceFillContainer:r,activateReverseInfiniteScroll:o},f=!1,u=".nop7SpikesAjaxFiltersGrid .item-box",d=".item-box.dummy-box",p=!1,m=!0,v=ajaxFiltersHistory.state().scrollPosition;return c};