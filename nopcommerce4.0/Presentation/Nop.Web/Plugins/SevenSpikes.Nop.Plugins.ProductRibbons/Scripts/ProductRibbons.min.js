!function(t,r,o){function e(){var t=o.getAttrValFromDom(i,"data-productPagePicturesParentContainerSelector"),e=[],a={},d=o.getAttrValFromDom(i,"data-productId");if(d&&d>0&&t){var n=r(t).find(".product-ribbon");n&&0!==n.length||(a.productId=d,a.productElement=r(t))}return r(c).each(function(){var t=r(this).find(".product-ribbon");if(!t||0===t.length){var o=r(this).attr("data-productid");if(o&&o>0){var a={productId:o,productElement:r(this)};e.push(a)}}}),{productPage:a,categoryPageProducts:e}}function a(t,e,a){var d;if(e.productElement){if(a){if(!(d=o.getAttrValFromDom(i,"data-productPageBugPictureContainerSelector")))return}else if(!(d=o.getAttrValFromDom(i,"data-productBoxPictureContainerSelector")))return;var n=e.productElement.find(d);if(n.parent().hasClass(u))return;if(n&&e.productId&&e.productId>0){var c,p=e.productId;(c=a?r(t).filter("div[data-productId='"+p+"']"):r(t).filter("a[data-productId='"+p+"']"))&&c.length>0&&(n.wrap('<div class="'+u+'"></div>'),n.after(c))}}}function d(t,r){if(r&&r.productPage&&r.productPage.productId&&a(t,r.productPage,!0),r&&r.categoryPageProducts&&r.categoryPageProducts.length>0)for(var o=0;o<r.categoryPageProducts.length;o++)a(t,r.categoryPageProducts[o])}function n(){return o.getAttrValFromDom("#product-ribbon-info","data-retrieveproductribbonsurl")}var c,u="ribbon-wrapper",i="#product-ribbon-info";t.showRibbons=function(){var t=0,o=[],a=e();if(a&&a.productPage&&a.productPage.productId&&(t=a.productPage.productId),a&&a.categoryPageProducts&&a.categoryPageProducts.length>0)for(var c=0;c<a.categoryPageProducts.length;c++){var u=a.categoryPageProducts[c];u.hasOwnProperty("productId")&&o.push(u.productId)}if(t||0!==o.length){r.isNumeric(t)||(t=0);var i={productPageId:t,categoryPageIds:o},p=n();r.ajax({type:"POST",data:r.toJSON(i),contentType:"application/json; charset=utf-8",url:p}).done(function(t){t&&(d(t,a),r.event.trigger({type:"nopProductRibbonsLoadingCompleteEvent"}))})}},r(document).ready(function(){(c=o.getAttrValFromDom(i,"data-productBoxSelector"))&&t.showRibbons()}),r(document).on("nopAjaxFiltersFiltrationCompleteEvent newProductsAddedToPageEvent",nopProductRibbons.showRibbons)}(window.nopProductRibbons=window.nopProductRibbons||{},jQuery,sevenSpikesCore);